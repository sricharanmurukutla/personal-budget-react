{"ast":null,"code":"import React,{useState}from'react';import{Link,useNavigate}from'react-router-dom';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPage=()=>{const[username,setUsername]=useState('');const[password,setPassword]=useState('');const navigate=useNavigate();const handleLogin=async()=>{try{const response=await fetch('http://localhost:3000/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});if(response.ok){const userData=await response.json();if(userData.accessToken){// Call handleToken to set the token and expiration time in local storage\nhandleToken(userData.accessToken);const decodedToken=decodeToken(userData.accessToken);if(decodedToken&&decodedToken.userId){const userId=decodedToken.userId;const firstname=userData.firstname;localStorage.setItem('userId',userId);localStorage.setItem('firstname',firstname);navigate('/homepage');}else{console.error('User ID not found in decoded token:',decodedToken);toast.error('Invalid login credentials',{position:toast.POSITION.TOP_CENTER});}}else{console.error('Access token not found in server response:',userData);}}else{alert('Invalid login credentials');}}catch(error){console.error('Error during login:',error);}};const handleToken=token=>{// Set the token in local storage\nlocalStorage.setItem(\"token\",token);// Set the expiration time (e.g., 1 minute from now)\nconst expirationTime=new Date().getTime()+60*1000;// 1 minute\nlocalStorage.setItem(\"tokenExpiration\",expirationTime);};const decodeToken=token=>{try{const decodedString=atob(token.split('.')[1]);const decodedObject=JSON.parse(decodedString);return decodedObject;}catch(error){console.error('Error decoding token:',error);return null;}};return/*#__PURE__*/_jsxs(\"div\",{style:styles.container,children:[/*#__PURE__*/_jsx(\"h2\",{style:styles.heading,children:\"Login Page\"}),/*#__PURE__*/_jsxs(\"form\",{style:styles.form,children:[/*#__PURE__*/_jsxs(\"label\",{style:styles.label,children:[\"Username:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:e=>setUsername(e.target.value),style:styles.input})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{style:styles.label,children:[\"Password:\",/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),autoComplete:\"current-password\",style:styles.input})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleLogin,style:styles.button,children:\"Login\"}),/*#__PURE__*/_jsx(ToastContainer,{})]}),/*#__PURE__*/_jsx(Link,{to:\"/register\",style:styles.registerButton,children:\"If new user ? Register\"})]});};const styles={container:{maxWidth:'400px',margin:'50px auto',padding:'20px',boxShadow:'0 5px 10px rgba(0,0,0,0.2)',backgroundColor:'#f5f5f5',// Light gray background color\nborderRadius:'8px'},heading:{fontSize:'24px',fontWeight:'500',color:'#333',textAlign:'center',marginBottom:'20px'},form:{display:'flex',flexDirection:'column'},label:{fontSize:'16px',fontWeight:'500',color:'#333',marginBottom:'10px'},input:{height:'40px',width:'100%',outline:'none',border:'none',padding:'0 10px',fontSize:'16px',fontWeight:'500',borderBottom:'2px solid rgba(0,0,0,0.2)',transition:'all 0.3s ease'},button:{marginTop:'20px',color:'#fff',backgroundColor:'#7d2ae8',// Purple button color\nborderRadius:'6px',padding:'10px',cursor:'pointer',transition:'all 0.4s ease',border:'none',outline:'none'},registerButton:{display:'block',marginTop:'10px',color:'#5b13b9',cursor:'pointer',textDecoration:'none',textAlign:'center',fontWeight:'500',transition:'color 0.4s ease'}};export default LoginPage;","map":{"version":3,"names":["React","useState","Link","useNavigate","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","LoginPage","username","setUsername","password","setPassword","navigate","handleLogin","response","fetch","method","headers","body","JSON","stringify","ok","userData","json","accessToken","handleToken","decodedToken","decodeToken","userId","firstname","localStorage","setItem","console","error","position","POSITION","TOP_CENTER","alert","token","expirationTime","Date","getTime","decodedString","atob","split","decodedObject","parse","style","styles","container","children","heading","form","label","type","value","onChange","e","target","input","autoComplete","onClick","button","to","registerButton","maxWidth","margin","padding","boxShadow","backgroundColor","borderRadius","fontSize","fontWeight","color","textAlign","marginBottom","display","flexDirection","height","width","outline","border","borderBottom","transition","marginTop","cursor","textDecoration"],"sources":["C:/Users/Sri Charan/Downloads/personal-budget-react (3)/personal-budget-react/personal-budget-react/client/src/LoginPage/LoginPage.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\n\r\nconst LoginPage = () => {\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const handleLogin = async () => {\r\n    try {\r\n      const response = await fetch('http://localhost:3000/api/login', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ username, password }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        const userData = await response.json();\r\n\r\n        if (userData.accessToken) {\r\n          // Call handleToken to set the token and expiration time in local storage\r\n          handleToken(userData.accessToken);\r\n\r\n          const decodedToken = decodeToken(userData.accessToken);\r\n\r\n          if (decodedToken && decodedToken.userId) {\r\n            const userId = decodedToken.userId;\r\n            const firstname = userData.firstname;\r\n\r\n            localStorage.setItem('userId', userId);\r\n            localStorage.setItem('firstname', firstname);\r\n\r\n            navigate('/homepage');\r\n          } else {\r\n            console.error('User ID not found in decoded token:', decodedToken);\r\n            toast.error('Invalid login credentials', {\r\n              position: toast.POSITION.TOP_CENTER,\r\n            });\r\n          }\r\n        } else {\r\n          console.error('Access token not found in server response:', userData);\r\n        }\r\n      } else {\r\n        alert('Invalid login credentials');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error during login:', error);\r\n    }\r\n  };\r\n\r\n\r\n  const handleToken = (token) => {\r\n    // Set the token in local storage\r\n    localStorage.setItem(\"token\", token);\r\n  \r\n    // Set the expiration time (e.g., 1 minute from now)\r\nconst expirationTime = new Date().getTime() + 60 * 1000; // 1 minute\r\n\r\n    localStorage.setItem(\"tokenExpiration\", expirationTime);\r\n  };\r\n  \r\n  const decodeToken = (token) => {\r\n    try {\r\n      const decodedString = atob(token.split('.')[1]);\r\n      const decodedObject = JSON.parse(decodedString);\r\n      return decodedObject;\r\n    } catch (error) {\r\n      console.error('Error decoding token:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      <h2 style={styles.heading}>Login Page</h2>\r\n      <form style={styles.form}>\r\n        <label style={styles.label}>\r\n          Username:\r\n          <input\r\n            type=\"text\"\r\n            value={username}\r\n            onChange={(e) => setUsername(e.target.value)}\r\n            style={styles.input}\r\n          />\r\n        </label>\r\n        <br />\r\n        <label style={styles.label}>\r\n          Password:\r\n          <input\r\n            type=\"password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            autoComplete=\"current-password\"\r\n            style={styles.input}\r\n          />\r\n        </label>\r\n        <br />\r\n        <button type=\"button\" onClick={handleLogin} style={styles.button}>\r\n          Login\r\n        </button>\r\n        <ToastContainer />\r\n      </form>\r\n      <Link to=\"/register\" style={styles.registerButton}>\r\n        If new user ? Register\r\n      </Link>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    maxWidth: '400px',\r\n    margin: '50px auto',\r\n    padding: '20px',\r\n    boxShadow: '0 5px 10px rgba(0,0,0,0.2)',\r\n    backgroundColor: '#f5f5f5', // Light gray background color\r\n    borderRadius: '8px',\r\n  },\r\n  heading: {\r\n    fontSize: '24px',\r\n    fontWeight: '500',\r\n    color: '#333',\r\n    textAlign: 'center',\r\n    marginBottom: '20px',\r\n  },\r\n  form: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  label: {\r\n    fontSize: '16px',\r\n    fontWeight: '500',\r\n    color: '#333',\r\n    marginBottom: '10px',\r\n  },\r\n  input: {\r\n    height: '40px',\r\n    width: '100%',\r\n    outline: 'none',\r\n    border: 'none',\r\n    padding: '0 10px',\r\n    fontSize: '16px',\r\n    fontWeight: '500',\r\n    borderBottom: '2px solid rgba(0,0,0,0.2)',\r\n    transition: 'all 0.3s ease',\r\n  },\r\n  button: {\r\n    marginTop: '20px',\r\n    color: '#fff',\r\n    backgroundColor: '#7d2ae8', // Purple button color\r\n    borderRadius: '6px',\r\n    padding: '10px',\r\n    cursor: 'pointer',\r\n    transition: 'all 0.4s ease',\r\n    border: 'none',\r\n    outline: 'none',\r\n  },\r\n  registerButton: {\r\n    display: 'block',\r\n    marginTop: '10px',\r\n    color: '#5b13b9',\r\n    cursor: 'pointer',\r\n    textDecoration: 'none',\r\n    textAlign: 'center',\r\n    fontWeight: '500',\r\n    transition: 'color 0.4s ease',\r\n  },\r\n};\r\n\r\nexport default LoginPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}